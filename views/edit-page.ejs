<html>
    <head>
        <!-- DATADOG RUM-->
        <script
            src="https://www.datadoghq-browser-agent.com/datadog-rum-us.js"
            type="text/javascript">
        </script>
        <script>
            window.DD_RUM && window.DD_RUM.init({
                clientToken: '<%= rum.clientToken %>',
                applicationId: '<%= rum.applicationId %>',
                env: '<%= rum.env %>',
                service: '<%= rum.service %>',
                version: '<%= rum.version %>',
                allowedTracingOrigins: [/http:\/\/localhost:3000/],
                trackInteractions: true
            });
        </script>

        <!-- AJAX & CSS -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <link href="/stylesheets/style.css" type="text/css" rel="stylesheet">

        <title>Datablog</title>
    </head>
    <body>
        <header>
            <div class="left">
                <div class="left">
                    <h1>Editing Page: <span id="page"><%= id %></span></h1>
                </div>   
                <div class="right">
                    <h1>Created: <%= niceDate %></h1>
                </div>
            </div> 

            <div class="right">
                <div class =right">
                    <a href="/"><button class="home-button">Home</button></a>
                </div>
            </div>
        </header>

        <div>
            <div class="left">
                <!-- Form for inputing page data -->
                <form method="PUT" id="page">
                    <label class="title">Title</label>
                    <input class="page-input-text" id="title" value="<%= title %>"></input>
                    <label class="body">Body</label>
                    <textarea class="page-input-text" id="body" placeholder="Input body here"><%= body %></textarea>
                    <button class="submit-button">Submit</button>
                </form> 
            </div>
            <div class="right">
                <!--
                <div class="placeholder-image">Placeholder Image</span>
                -->
            </div>
        </div>
       

        <!-- Script for submitting page -->
        <script>
            $('.submit-button').click(function(){
                $.ajax({ 
                    url: '/api/page/' + $('#page').text(),
                    dataType: 'json',
                    data: {
                        "id": '<%= id %>',
                        "title": $('#title').val(),
                        "body": $('#body').val()
                    },
                    type: 'PUT',
                    success: function(result) {   
                        console.log("Successful post");
                        console.log("Resulting Page: " + JSON.stringify(result));
                        var page = JSON.parse(JSON.stringify(result)); 
                        console.log("ID: " + page.id);
                        window.location='/page/' + page.id;
                    },
                    error: function(result) {
                        console.log("Error: " + result);
                    }
                });
            });
		</script>

       
    </body>
</html>